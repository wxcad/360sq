//滚动图片构造函数
function ScrollPic(e,t,n,r,i){this.scrollContId=e,this.arrLeftId=t,this.arrRightId=n,this.dotListId=r,this.listType=i,this.dotClassName="",this.dotOnClassName="on",this.dotObjArr=[],this.listEvent="onclick",this.circularly=!0,this.pageWidth=0,this.frameWidth=0,this.speed=10,this.space=10,this.upright=!1,this.pageIndex=0,this.autoPlay=!0,this.autoPlayTime=5,this._autoTimeObj,this._scrollTimeObj,this._state="ready",this.stripDiv=document.createElement("DIV"),this.lDiv01=document.createElement("DIV"),this.lDiv02=document.createElement("DIV")}ScrollPic.prototype={version:"1.41",author:"mengjia",pageLength:0,touch:!0,initialize:function(){var e=this;if(!this.scrollContId)throw new Error("必须指定scrollContId.");this.scDiv=this.$(this.scrollContId);if(!this.scDiv)throw new Error('scrollContId不是正确的对象.(scrollContId = "'+this.scrollContId+'")');this.scDiv.style[this.upright?"height":"width"]=this.frameWidth+"px",this.scDiv.style.overflow="hidden",this.lDiv01.innerHTML=this.scDiv.innerHTML,this.scDiv.innerHTML="",this.scDiv.appendChild(this.stripDiv),this.stripDiv.appendChild(this.lDiv01),this.circularly&&(this.stripDiv.appendChild(this.lDiv02),this.lDiv02.innerHTML=this.lDiv01.innerHTML),this.stripDiv.style.overflow="hidden",this.stripDiv.style.zoom="1",this.stripDiv.style[this.upright?"height":"width"]="32766px",this.upright||(this.lDiv01.style.cssFloat="left",this.lDiv01.style.styleFloat="left",this.lDiv01.style.overflow="hidden"),this.lDiv01.style.zoom="1",this.circularly&&!this.upright&&(this.lDiv02.style.cssFloat="left",this.lDiv02.style.styleFloat="left",this.lDiv02.style.overflow="hidden"),this.lDiv02.style.zoom="1",this.addEvent(this.scDiv,"mouseover",function(){e.stop()}),this.addEvent(this.scDiv,"mouseout",function(){e.play()}),this.arrLeftId&&(this.alObj=this.$(this.arrLeftId),this.alObj&&(this.addEvent(this.alObj,"mousedown",function(){e.rightMouseDown()}),this.addEvent(this.alObj,"mouseup",function(){e.rightEnd()}),this.addEvent(this.alObj,"mouseout",function(){e.rightEnd()}))),this.arrRightId&&(this.arObj=this.$(this.arrRightId),this.arObj&&(this.addEvent(this.arObj,"mousedown",function(){e.leftMouseDown()}),this.addEvent(this.arObj,"mouseup",function(){e.leftEnd()}),this.addEvent(this.arObj,"mouseout",function(){e.leftEnd()})));var t=Math.ceil(this.lDiv01[this.upright?"offsetHeight":"offsetWidth"]/this.frameWidth),n,r;this.pageLength=t;if(this.dotListId){this.dotListObj=this.$(this.dotListId),this.dotListObj.innerHTML="";if(this.dotListObj)for(n=0;n<t;n++)r=document.createElement("span"),this.dotListObj.appendChild(r),this.dotObjArr.push(r),n==this.pageIndex?r.className=this.dotOnClassName:r.className=this.dotClassName,this.listType=="number"?r.innerHTML=n+1:typeof this.listType=="string"?r.innerHTML=this.listType:r.innerHTML="",r.title=""+(n+1)+"",r.num=n,r[this.listEvent]=function(){e.pageTo(this.num)}}this.scDiv[this.upright?"scrollTop":"scrollLeft"]=0,this.autoPlay&&this.play(),this._scroll=this.upright?"scrollTop":"scrollLeft",this._sWidth=this.upright?"scrollHeight":"scrollWidth",typeof this.onpagechange=="function"&&this.onpagechange(),this.iPad()},leftMouseDown:function(){if(this._state!="ready")return;var e=this;this._state="floating",clearInterval(this._scrollTimeObj),this.moveLeft(),this._scrollTimeObj=setInterval(function(){e.moveLeft()},this.speed)},rightMouseDown:function(){if(this._state!="ready")return;var e=this;this._state="floating",clearInterval(this._scrollTimeObj),this.moveRight(),this._scrollTimeObj=setInterval(function(){e.moveRight()},this.speed)},moveLeft:function(){this.circularly?this.scDiv[this._scroll]+this.space>=this.lDiv01[this._sWidth]?this.scDiv[this._scroll]=this.scDiv[this._scroll]+this.space-this.lDiv01[this._sWidth]:this.scDiv[this._scroll]+=this.space:this.scDiv[this._scroll]+this.space>=this.lDiv01[this._sWidth]-this.frameWidth?(this.scDiv[this._scroll]=this.lDiv01[this._sWidth]-this.frameWidth,this.leftEnd()):this.scDiv[this._scroll]+=this.space,this.accountPageIndex()},moveRight:function(){this.circularly?this.scDiv[this._scroll]-this.space<=0?this.scDiv[this._scroll]=this.lDiv01[this._sWidth]+this.scDiv[this._scroll]-this.space:this.scDiv[this._scroll]-=this.space:this.scDiv[this._scroll]-this.space<=0?(this.scDiv[this._scroll]=0,this.rightEnd()):this.scDiv[this._scroll]-=this.space,this.accountPageIndex()},leftEnd:function(){if(this._state!="floating"&&this._state!="touch")return;this._state="stoping",clearInterval(this._scrollTimeObj);var e=this.pageWidth-this.scDiv[this._scroll]%this.pageWidth;this.move(e)},rightEnd:function(){if(this._state!="floating"&&this._state!="touch")return;this._state="stoping",clearInterval(this._scrollTimeObj);var e=-this.scDiv[this._scroll]%this.pageWidth;this.move(e)},move:function(e,t){var n=this,r=e/5,i=!1;t||(r>this.space&&(r=this.space),r<-this.space&&(r=-this.space)),Math.abs(r)<1&&r!=0?r=r>=0?1:-1:r=Math.round(r);var s=this.scDiv[this._scroll]+r;r>0?this.circularly?this.scDiv[this._scroll]+r>=this.lDiv01[this._sWidth]?this.scDiv[this._scroll]=this.scDiv[this._scroll]+r-this.lDiv01[this._sWidth]:this.scDiv[this._scroll]+=r:this.scDiv[this._scroll]+r>=this.lDiv01[this._sWidth]-this.frameWidth?(this.scDiv[this._scroll]=this.lDiv01[this._sWidth]-this.frameWidth,this._state="ready",i=!0):this.scDiv[this._scroll]+=r:this.circularly?this.scDiv[this._scroll]+r<0?this.scDiv[this._scroll]=this.lDiv01[this._sWidth]+this.scDiv[this._scroll]+r:this.scDiv[this._scroll]+=r:this.scDiv[this._scroll]-r<0?(this.scDiv[this._scroll]=0,this._state="ready",i=!0):this.scDiv[this._scroll]+=r,typeof this.onpagechange=="function"&&this.onpagechange();if(i)return;e-=r;if(Math.abs(e)==0){this._state="ready",this.autoPlay&&this.play(),this.accountPageIndex();return}this.accountPageIndex(),this._scrollTimeObj=setTimeout(function(){n.move(e,t)},this.speed)},pre:function(){if(this._state!="ready")return;this._state="stoping",this.pageTo(this.pageIndex-1)},next:function(e){if(this._state!="ready")return;this._state="stoping",this.circularly?this.pageTo(this.pageIndex+1):this.scDiv[this._scroll]>=this.lDiv01[this._sWidth]-this.frameWidth?(this._state="ready",e&&this.pageTo(0)):this.pageTo(this.pageIndex+1)},play:function(){var e=this;if(!this.autoPlay)return;clearInterval(this._autoTimeObj),this._autoTimeObj=setInterval(function(){e.next(!0)},this.autoPlayTime*1e3)},stop:function(){clearInterval(this._autoTimeObj)},pageTo:function(e){if(this.pageIndex==e)return;e<0&&(e=this.pageLength-1),clearTimeout(this._scrollTimeObj),this._state="stoping";var t=e*this.frameWidth-this.scDiv[this._scroll];this.move(t,!0)},accountPageIndex:function(){var e=Math.floor(this.scDiv[this._scroll]/this.frameWidth);if(e==this.pageIndex)return;this.pageIndex=e,this.pageIndex>Math.floor(this.lDiv01[this.upright?"offsetHeight":"offsetWidth"]/this.frameWidth)&&(this.pageIndex=0);var t;for(t=0;t<this.dotObjArr.length;t++)t==this.pageIndex?this.dotObjArr[t].className=this.dotOnClassName:this.dotObjArr[t].className=this.dotClassName;typeof this.onpagechange=="function"&&this.onpagechange()},iPadX:0,iPadLastX:0,iPadStatus:"ok",iPad:function(){if(typeof window.ontouchstart=="undefined")return;if(!this.touch)return;var e=this;this.addEvent(this.scDiv,"touchstart",function(t){e._touchstart(t)}),this.addEvent(this.scDiv,"touchmove",function(t){e._touchmove(t)}),this.addEvent(this.scDiv,"touchend",function(t){e._touchend(t)})},_touchstart:function(e){this.stop(),this.iPadX=e.touches[0].pageX,this.iPadScrollX=window.pageXOffset,this.iPadScrollY=window.pageYOffset,this.scDivScrollLeft=this.scDiv[this._scroll]},_touchmove:function(e){if(e.touches.length>1){this.iPadStatus="ok";return}this.iPadLastX=e.touches[0].pageX;var t=this.iPadX-this.iPadLastX;if(this.iPadStatus=="ok"){if(!(this.iPadScrollY==window.pageYOffset&&this.iPadScrollX==window.pageXOffset&&Math.abs(t)>20))return;this.iPadStatus="touch"}this._state="touch";var n=this.scDivScrollLeft+t;n>=this.lDiv01[this._sWidth]&&(n-=this.lDiv01[this._sWidth]),n<0&&(n+=this.lDiv01[this._sWidth]),this.scDiv[this._scroll]=n,e.preventDefault()},_touchend:function(e){if(this.iPadStatus!="touch")return;this.iPadStatus="ok";var t=this.iPadX-this.iPadLastX;t<0?this.rightEnd():this.leftEnd(),this.play()},$:function(objName){return document.getElementById?eval('document.getElementById("'+objName+'")'):eval("document.all."+objName)},isIE:navigator.appVersion.indexOf("MSIE")!=-1?!0:!1,addEvent:function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)},delEvent:function(e,t,n){e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,!1)},readCookie:function(e){var t="",n=e+"=";if(document.cookie.length>0){var r=document.cookie.indexOf(n);if(r!=-1){r+=n.length;var i=document.cookie.indexOf(";",r);i==-1&&(i=document.cookie.length),t=unescape(document.cookie.substring(r,i))}}return t},writeCookie:function(e,t,n,r){var i="",s="";n!=null&&(i=new Date((new Date).getTime()+n*36e5),i="; expires="+i.toGMTString()),r!=null&&(s=";domain="+r),document.cookie=e+"="+escape(t)+i+s},readStyle:function(e,t){if(e.style[t])return e.style[t];if(e.currentStyle)return e.currentStyle[t];if(document.defaultView&&document.defaultView.getComputedStyle){var n=document.defaultView.getComputedStyle(e,null);return n.getPropertyValue(t)}return null}};